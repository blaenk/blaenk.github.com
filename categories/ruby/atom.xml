<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Ruby | Jorge Israel Peña]]></title>
  <link href="http://blaenkdenum.com/categories/ruby/atom.xml" rel="self"/>
  <link href="http://blaenkdenum.com/"/>
  <updated>2013-03-22T20:50:49-07:00</updated>
  <id>http://blaenkdenum.com/</id>
  <author>
    <name><![CDATA[Jorge Israel Peña]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Commit Tag for Jekyll]]></title>
    <link href="http://blaenkdenum.com/posts/commit-tag-for-jekyll/"/>
    <updated>2013-03-22T19:45:00-07:00</updated>
    <id>http://blaenkdenum.com/posts/commit-tag-for-jekyll</id>
    <content type="html"><![CDATA[<p>I’ve been touching up my site and I got to the footer part of the site where I used to display the last time the site was generated, something like “generated March 22nd, 2013.” I decided this was pretty tacky and removed it, but I did want to have something in the footer. Eventually I got the idea to instead put a short SHA1 hash of the latest commit for the site. It would link to the github page for said commit, and on hover of the link it would show the commit message.</p>

<p>After having seen previous plugin implementations, it seemed pretty simple enough. I quickly brought up the page for <a href="https://github.com/libgit2/rugged">rugged</a>, <a href="http://libgit2.github.com/">libgit2’s</a> ruby bindings.</p>

<p><blockquote><p>libgit2 is a portable, pure C implementation of the Git core methods provided as a re-entrant linkable library with a solid API, allowing you to write native speed custom Git applications in any language which supports C bindings.</p><footer><strong>About</strong> <cite><a href='http://libgit2.github.com/'>libgit2 </a></cite></footer></blockquote></p>

<p>The end result is the commit tag plugin which quite simply lets you insert a link to the latest commit of your site with the following properties:</p>

<ul>
  <li>the link text is the short-form, 8-character truncated SHA1 hash to the commit pointed to by HEAD on the default branch, <code>source</code> in my case</li>
  <li>the link title text is the commit message</li>
  <li>the link target is the github page for the commit</li>
</ul>

<p>The plugin is available in my <a href="https://github.com/blaenk/blaenk.github.com/blob/source/plugins/commit.rb">site’s repository</a>. Here it is in its entirety:</p>

<p>``` ruby
require ‘rugged’</p>

<p>module Jekyll
  class Commit &lt; Liquid::Tag
    MATCHER = /\A(\S+)\Z/
    def render(context)
      path = Rugged::Repository.discover(‘.’)
      repo = Rugged::Repository.new(path)</p>

<pre><code>  sha = repo.head.target
  message = repo.lookup(sha).message.strip
  markup = @markup.strip

  if not markup.empty?
    repo = markup.match(MATCHER)[1]
    "&lt;a href=\"https://github.com/#{repo}/commit/#{sha}\" title=\"#{message}\"&gt;#{sha[0...8]}&lt;/a&gt;"
  else
    "&lt;span title=\"#{message}\"&gt;#{sha[0...8]}&lt;/span&gt;"
  end
end   end end
</code></pre>

<p>Liquid::Template.register_tag(‘commit’, Jekyll::Commit)
```</p>

<p>The commit tag is simple to use, taking only one parameter which denotes the repository to link to, in my case:</p>

<p><code>plain
{% commit blaenk/blaenk.github.com %}
</code></p>

<p>This format is similar to <a href="https://github.com/gmarik/vundle">vundle’s</a>, a plugin management plugin for vim. Alternatively, if no parameter is given – i.e. just <code>{% commit %}</code> – then instead of a link it produces a <code>span</code> tag with the short-form hash and commit message as title text.</p>

<p>Of course, this is a very simple plugin and makes many assumptions (i.e. that you’re using github), but it’s simple enough that you should be able to modify it to your purpose easily.</p>

<p>One thing to be mindful of is that the tag is evaluated at the point in which your site is generated. That is, if you generate your site, <em>then</em> make a commit and deploy, the tag will be evaluated such that it displays the previous commit instead. This is simply the nature of static site generation. All that’s required is to generate the site after having made the commits you make. To automate this, I made my <code>Rakefile</code>’s <code>deploy</code> tag execute the <code>generate</code> task. This way is more natural in my opinion, as I’m used to deploying only after commiting my changes.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Test Post]]></title>
    <link href="http://blaenkdenum.com/posts/test-post/"/>
    <updated>2012-09-19T02:49:00-07:00</updated>
    <id>http://blaenkdenum.com/posts/test-post</id>
    <content type="html"><![CDATA[<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent dolor nisi, feugiat sit amet egestas sit amet, mattis sit amet velit. Proin quis metus id mi vulputate adipiscing eget et <strong>sapien</strong>. Sed iaculis auctor sem ac convallis <sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>. Cras nisi libero, dignissim quis facilisis et, bibendum eget enim. Vivamus est leo, tristique ut adipiscing vitae, malesuada adipiscing tellus. Integer nec aliquam justo. Nam ac lacus erat. In <strong><em>hac habitasse platea</em></strong> dictumst. Donec pharetra, lectus sit amet ultrices fringilla, metus mi auctor ligula, in hendrerit dui arcu eu leo.</p>

<p>Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Nulla facilisi. Vestibulum consectetur nulla eget erat <em>fermentum malesuada</em>. Nullam ultricies nulla ut eros vulputate sed cursus tortor faucibus. Cras ac risus mauris. Suspendisse molestie elementum luctus. Vestibulum <a href="http://www.google.com">venenatis blandit</a> velit ac pretium.</p>

<script type="math/tex; mode=display"> i\hbar\frac{\partial \psi}{\partial t}
  = \frac{-\hbar^2}{2m} \left(
    \frac{\partial^2}{\partial x^2}
    + \frac{\partial^2}{\partial y^2}
    + \frac{\partial^2}{\partial z^2}
  \right) \psi + V \psi </script>

<p>Nulla facilisi. Cras lectus velit, rhoncus et mollis eget, ultricies quis ligula. Integer ornare nibh in est molestie tempus. Praesent bibendum placerat diam id gravida. Fusce et velit eget dui laoreet interdum eget id arcu. Ut et massa nibh, ut mollis augue. In hac habitasse platea dictumst. Sed massa orci, <strong>venenatis</strong> vitae dapibus sit amet, varius ut nibh. Ut vel enim leo, at posuere nisi. In elementum sem vel nibh malesuada sagittis.</p>

<script type="math/tex; mode=display">R_{ab} - {\textstyle 1 \over 2}R\,g_{ab} + \Lambda\ g_{ab} = \kappa\, T_{ab}</script>

<p>Nulla facilisi. Cras lectus velit, rhoncus et mollis eget, ultricies quis ligula. Integer ornare nibh in est molestie tempus. Praesent bibendum placerat diam id gravida. Fusce et velit eget dui laoreet interdum eget id arcu. Ut et massa nibh, ut mollis augue. In hac habitasse platea dictumst. Sed massa orci, venenatis vitae dapibus sit amet, varius ut nibh. Ut vel enim leo, at posuere nisi. In elementum sem vel nibh malesuada sagittis.</p>

<p>``` ruby an example of base64 decoding in ruby https://gist.github.com/3759076 gist
require ‘base64’</p>

<p>File.open(‘favicon.png’, ‘wb’) do |f|
  f.write(Base64.decode64(base64))
end
```</p>

<p>Donec vitae turpis non augue pulvinar imperdiet eu non erat. Integer mollis diam ac quam lobortis luctus. Suspendisse scelerisque sodales massa sit amet pharetra. <script type="math/tex">\Delta S = \pi</script> <sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup> Donec cursus, velit in mollis dapibus, nunc elit pharetra erat, et dictum sem sapien pretium ligula. Cras nibh elit, mollis eu eleifend sed, faucibus in velit. Aliquam gravida tristique molestie. Donec gravida, diam ac auctor auctor, nulla enim varius sem, non auctor urna mi vitae enim. Cras aliquam semper nibh, quis viverra urna ultrices et. Nunc rhoncus fringilla dapibus.</p>

<p><img class="center" src="http://placekitten.com/720/250"></p>

<h1 id="immortal-words">Immortal Words</h1>

<p><blockquote><p>Too many people have opinions on things they know nothing about. And the more ignorant they are, the more opinions they have.</p><footer><strong>Thomas Hildern</strong> <cite><a href='http://fallout.wikia.com/wiki/Thomas_Hildern'>Fallout Wiki </a></cite></footer></blockquote></p>

<h2 id="the-meaning-of-life">The Meaning of Life</h2>

<p><img class="right" src="http://placekitten.com/150/100" title="Place Kitten #3" >
Aenean tristique, magna a semper venenatis, orci odio tempor lorem, ac molestie ligula enim ac urna. Fusce egestas nisl id massa porta vitae pretium tellus aliquet. Morbi tempor arcu sit amet felis hendrerit aliquam. Nulla facilisi. Suspendisse diam tortor, pharetra ac porta eu, ullamcorper nec lectus. Sed nulla turpis, blandit et tincidunt vel, <code>condimentum</code> et sapien. Aliquam dignissim blandit pharetra. Mauris ornare accumsan libero at bibendum. Morbi dui nisl, aliquet sit amet gravida sit amet, mollis commodo nulla. Quisque eu felis purus.</p>

<script type="math/tex; mode=display">% &lt;![CDATA[
 \forall x, y : \mathbb{Z}, x > 3 \land y < 2 \Rightarrow x^2 - 2y > 5 %]]&gt;</script>

<p>Aenean mauris augue, faucibus vel sagittis nec, viverra sit amet sapien. Etiam neque nisi, molestie vel lacinia a, scelerisque eget justo. Suspendisse imperdiet lectus eu metus malesuada vel vehicula libero rutrum. Nulla facilisi. In lectus nisl, semper ac imperdiet eu, ultricies luctus erat. Sed ultrices lectus in <code>massa tincidunt</code> fringilla. Aenean lectus tortor, tempus a sagittis vitae, hendrerit eget lacus.</p>

<h3 id="things-to-do">Things to do</h3>

<ul>
  <li>first do this</li>
  <li>then do this other thing</li>
  <li>then maybe, if you’re not tired, do this last thing</li>
</ul>

<p>Here it is numbered for you:</p>

<ol>
  <li>first do this</li>
  <li>then do this other thing</li>
  <li>then maybe, if you’re not tired, do this last thing</li>
</ol>

<p>As you can see, there’s lots of work to do! Aenean mauris augue, faucibus vel sagittis nec, viverra sit amet sapien. Etiam neque nisi, molestie vel lacinia a, scelerisque eget justo. Suspendisse imperdiet lectus eu metus malesuada vel vehicula libero rutrum. Nulla facilisi. In lectus nisl, semper ac imperdiet eu, ultricies luctus erat. Sed ultrices lectus in <code>massa tincidunt</code> fringilla. Aenean lectus tortor, tempus a sagittis vitae, hendrerit eget lacus.</p>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p>Cras nibh elit, mollis eu eleifend sed, faucibus in velit. <a href="#fnref:1" rel="reference">&#8617;</a></p>
    </li>
    <li id="fn:2">
      <p>This is the awesome constant <a href="#fnref:2" rel="reference">&#8617;</a></p>
    </li>
  </ol>
</div>
]]></content>
  </entry>
  
</feed>
